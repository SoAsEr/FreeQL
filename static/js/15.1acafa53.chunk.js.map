{"version":3,"sources":["reusable_components/formatting/FormattedChemicalCompound.js","utils/ref-utils.js","utils/ConstantValidationTextInput.js","utils/useResizeObserver.js","reusable_components/EditDefault.js","features/species/tableau/Tableau.js"],"names":["FormattedChemicalCompound","React","memo","props","regex","Array","from","children","matchAll","map","match","chargeValue","groups","ChargeValue1","ChargeValue2","reduce","prev","curr","chargeSign","ChargeSign1","ChargeSign2","terminator","EndMatcher1","EndMatcher2","EndMatcher3","EndMatcher4","key","substring","index","WordMatcher","SubMatcher","useCallbackRef","onUpdate","cleanupOld","onNull","ref","useRef","setRef","useCallback","node","current","mergeRefs","refs","filteredRefs","filter","Boolean","length","inst","ConstantValidationTextInput","child","Children","only","useState","value","setValue","selection","setSelection","validationMisfired","setValidationMisfire","selectRef","useEffect","selectionStart","selectionEnd","cloneElement","onSelect","e","target","onChange","validation","onBlur","defaultProps","useResizeObserver","callback","resizeObserverRef","getResizeObserverRef","ResizeObserver","entries","boundingRect","getBoundingClientRect","width","height","observe","unobserve","EditDefault","constantValidation","onSubmitValidation","onResetToDefault","onEdit","defaultValue","changedValue","showDefault","editing","setEditing","editBoxVal","setEditBoxVal","editBoxRef","useLayoutEffect","focus","onCancelEdit","onSubmitEdit","preventDefault","Form","onSubmit","Control","style","onKeyDown","keyCode","stopPropagation","className","onClick","viewBox","fill","xmlns","fillRule","d","LogKEditor","dbLogK","specie","type","dispatch","useDispatch","input","is_number","useSelector","state","getLogKChange","addLogKChange","Number","removeLogKChange","TableauTable","windowWidth","componentsPresent","getComponentsPresent","componentsAtEquilibium","getComponentsAtEquilibrium","componentsConc","getComponentsConc","componentDB","getComponentDB","gasReplacements","getGasReplacements","speciesPresent","getSpeciesPresent","speciesDB","getSpeciesDB","topLeftWidth","setTopLeftWidth","topLeftHeight","setTopLeftHeight","logKWidth","setLogKWidth","lg","headerColumn","useMemo","Header","Footer","id","accessor","name","dataColumns","Immutable","component","components","get","includes","logKColumn","logK","columns","unshift","push","data","aqs","solids","gases","flatten","tableInstance","useTable","getTableProps","getTableBodyProps","headerGroups","footerGroups","rows","prepareRow","topLeftRef","logKRef","autoHide","autoHeight","autoHeightMax","renderTrackHorizontal","finalStyle","update","$merge","right","bottom","left","borderRadius","marginLeft","marginRight","renderTrackVertical","top","marginTop","Table","striped","bordered","hover","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","render","row","getRowProps","cells","cell","getCellProps","group","getFooterGroupProps","getFooterProps"],"mappings":"gIAEMA,EAA0BC,IAAMC,MAAK,SAACC,GAW1C,IAAMC,EAAK,YAAC,qdAAD,uKAEX,OACE,wBAASD,EACJE,MAAMC,KAAKH,EAAMI,SAASC,SAASJ,IAAQK,KAAI,SAACC,GAC/C,IAAMC,EAAY,CAACD,EAAME,OAAOC,aAAcH,EAAME,OAAOE,cAAcC,QAAO,SAACC,EAAMC,GAAP,OAAgBA,GAAcD,IAAM,IAC9GE,EAAW,CAACR,EAAME,OAAOO,YAAaT,EAAME,OAAOQ,aAAaL,QAAO,SAACC,EAAMC,GAAP,OAAgBA,GAAcD,IAAM,IAC3GK,EAAW,CAACX,EAAME,OAAOU,YAAaZ,EAAME,OAAOW,YAAab,EAAME,OAAOY,YAAad,EAAME,OAAOa,aAAaV,QAAO,SAACC,EAAMC,GAAP,OAAgBA,GAAcD,IAAM,IACrK,OACE,0BAAMU,IAAKvB,EAAMI,SAASoB,UAAU,EAAGjB,EAAMkB,QAC1ClB,EAAME,OAAOiB,YAAY,6BAAMnB,EAAME,OAAOkB,YAAiB,6BAAMnB,EAAaO,GAAkBG,UAQlGrB,O,uHC7BT+B,EAAe,SAACC,EAAWC,GAAiC,IAArBC,EAAoB,uDAAb,aAC5CC,EAAMC,iBAAO,MACbC,EAASC,uBAAY,SAAAC,GACrBJ,EAAIK,SACNP,EAAWE,EAAIK,SAGbD,EACFP,EAASO,GAETL,IAGFC,EAAIK,QAAUD,IACb,CAACN,EAAYD,EAAUE,IAE1B,OAAOG,GAGHI,EAAY,WAAc,IAAD,uBAATC,EAAS,yBAATA,EAAS,gBAC7B,IAAMC,EAAeD,EAAKE,OAAOC,SACjC,OAAKF,EAAaG,OACU,IAAxBH,EAAaG,OAAqBH,EAAa,GAC5C,SAAAI,GAAS,IAAD,gBACKJ,GADL,IACb,2BAAgC,CAAC,IAAtBR,EAAqB,QACX,oBAARA,EACTA,EAAIY,GACKZ,IACTA,EAAIK,QAAUO,IALL,gCAFkB,O,qECpB7BC,EAA4B/C,IAAMC,MAAK,SAACC,GAC5C,IAAM8C,EAAMhD,IAAMiD,SAASC,KAAKhD,EAAMI,UADgB,EAE9B6C,mBAAS,IAFqB,mBAE/CC,EAF+C,KAExCC,EAFwC,OAGtBF,mBAAS,CAAC,EAAE,IAHU,mBAG/CG,EAH+C,KAGpCC,EAHoC,OAILJ,oBAAS,GAJJ,mBAI/CK,EAJ+C,KAI3BC,EAJ2B,KAKhDC,EAAUvB,iBAAO,MA0BvB,OAPAwB,qBAAU,WACLH,IACDE,EAAUnB,QAAQqB,eAAeN,EAAU,GAC3CI,EAAUnB,QAAQsB,aAAaP,EAAU,GACzCG,GAAqB,MAEtB,CAACD,EAAoBF,IAEtB,oCACGtD,IAAM8D,aAAad,EAAO,CAAEI,MAAOA,EAAOW,SAdhC,SAACC,GACVR,GACFD,EAAa,CAACS,EAAEC,OAAOL,eAAgBI,EAAEC,OAAOJ,gBAYeK,SAvBpD,SAACF,GACX9D,EAAMiE,WAAWH,EAAEC,OAAOb,QAC3BlD,EAAMgE,SAASF,GACfX,EAASW,EAAEC,OAAOb,OAClBG,EAAa,CAACS,EAAEC,OAAOL,eAAgBI,EAAEC,OAAOJ,gBAEhDJ,GAAqB,IAiB8DW,OA3B1E,SAACJ,GACZ9D,EAAMkE,OAAOJ,EAAGX,IA0BqFnB,IAAKM,YAAUQ,EAAMd,IAAKwB,SAInIX,EAA4BsB,aAAa,CACvCH,SAAU,aACVE,OAAQ,cAGKrB,O,qFCpBAuB,EAtBS,SAACC,GACvB,IAAMC,EAAkBrC,iBAAO,MACzBsC,EAAqBpC,uBAAY,WAOrC,OANImC,EAAkBjC,UACpBiC,EAAkBjC,QAAQ,IAAImC,gBAAe,SAACC,GAC5C,IAAMC,EAAaD,EAAQ,GAAGV,OAAOY,wBACrCN,EAAS,CAACO,MAAOF,EAAaE,MAAOC,OAAQH,EAAaG,aAGvDP,IACN,CAACA,EAAmBD,IASvB,OARczC,YACZO,uBAAY,SAACC,GACXmC,IAAuBlC,QAAQyC,QAAQ1C,KACvC,CAACmC,IACHpC,uBAAY,SAACC,GACXmC,IAAuBlC,QAAQ0C,UAAU3C,KACzC,CAACmC,M,sHC8DQS,EA7EKlF,IAAMC,MAAK,YAAsG,IAApGkF,EAAmG,EAAnGA,mBAAoBC,EAA+E,EAA/EA,mBAAoBC,EAA2D,EAA3DA,iBAAkBC,EAAyC,EAAzCA,OAAQC,EAAiC,EAAjCA,aAAcC,EAAmB,EAAnBA,aACzGC,GAAeD,EAD6G,EAEpGrC,oBAAS,GAF2F,mBAE3HuC,EAF2H,KAElHC,EAFkH,OAG9FxC,mBAAS,IAHqF,mBAG3HyC,EAH2H,KAG/GC,EAH+G,KAK5HC,EAAW3D,mBAEjB4D,2BAAiB,WACZL,GACDI,EAAWvD,QAAQyD,UAEpB,CAACN,EAASI,IAEb,IAAMG,EAAa,SAACjC,GAClB2B,GAAW,GACXE,EAAc,KAEVK,EAAa,SAAClC,GAClBA,EAAEmC,iBACCf,EAAmBQ,IACpBN,EAAOM,GAETK,KASF,OAAGP,EAEC,kBAACU,EAAA,EAAD,CAAMC,SAAUH,GACd,kBAACnD,EAAA,EAAD,CACEoB,WAAYgB,EACZjB,SAAU,SAACF,GACT6B,EAAc7B,EAAEC,OAAOb,QAEzBgB,OAAQ8B,GAER,kBAACE,EAAA,EAAKE,QAAN,CACEpE,IAAK4D,EACLS,MAAO,CAAC,MAAS,QACjBC,UAAW,SAACxC,GACK,KAAZA,EAAEyC,UACHzC,EAAEmC,iBACFnC,EAAE0C,kBACFT,UAMJR,EAEN,0BAAMkB,UAAU,eACbpB,EACD,yBAAKqB,QAlCK,SAAC5C,GACf2B,GAAW,IAiCkBgB,UAAU,cAAcJ,MAAO,CAAC,UAAa,WAAYzB,MAAM,MAAMC,OAAO,MAAM8B,QAAQ,YAAYC,KAAK,eAAeC,MAAM,8BACvJ,0BAAMC,SAAS,UAAUC,EAAE,mKAC3B,0BAAMD,SAAS,UAAUC,EAAE,4KAM/B,0BAAMN,UAAU,eACbnB,EACD,yBAAKoB,QAzCU,SAAC5C,GACpBqB,KAwCkCsB,UAAU,aAAaJ,MAAO,CAAC,UAAc,YAAazB,MAAM,MAAMC,OAAO,MAAM8B,QAAQ,YAAYC,KAAK,eAAeC,MAAM,8BAC7J,0BAAMC,SAAS,UAAUC,EAAE,sHAC3B,0BAAMD,SAAS,UAAUC,EAAE,mI,iBCrD/BC,EAAWlH,IAAMC,MAAK,SAACC,GAAW,IAC9BiH,EAAwBjH,EAAxBiH,OAAQC,EAAgBlH,EAAhBkH,OAAQC,EAAQnH,EAARmH,KAClBC,EAASC,cACf,OACE,kBAAC,EAAD,CACEpC,mBAAoB,SAACqC,GAAD,OAAWA,EAAM/G,MAAM,kBAC3C2E,mBAAoBqC,IACpBlC,aAAc4B,EACd3B,aAAckC,aAAY,SAAAC,GAAK,OAAIC,YAAcD,EAAO,CAACP,SAAQC,YACjE/B,OAAQ,SAAClC,GACPkE,EAASO,YAAc,CAACT,SAAQC,OAAMjE,MAAO0E,OAAO1E,OAEtDiC,iBAAkB,WAChBiC,EAASS,YAAiB,CAACX,SAAQC,gBAMrCW,EAAahI,IAAMC,MAAK,SAACC,GAAW,IACjC+H,EAAa/H,EAAb+H,YAEDC,EAAkBR,YAAYS,KAC9BC,EAAuBV,YAAYW,KACnCC,EAAeZ,YAAYa,KAC3BC,EAAYd,YAAYe,KACxBC,EAAgBhB,YAAYiB,KAE5BC,EAAelB,YAAYmB,KAC3BC,EAAUpB,YAAYqB,KAVW,EAYD5F,mBAAS,GAZR,mBAYhC6F,EAZgC,KAYlBC,EAZkB,OAaC9F,mBAAS,GAbV,mBAahC+F,EAbgC,KAajBC,EAbiB,OAcPhG,mBAAS,GAdF,mBAchCiG,EAdgC,KAcrBC,EAdqB,KAejCC,EAAGrB,GAAa,IAChBsB,EAAaC,mBAAQ,iBAAO,CAChCC,OAAQ,GACRC,OAAQ,kBAAO,oCAAE,0BAAM/C,UAAU,qBAAhB,uBAA8D,0BAAMA,UAAU,qBAAhB,iBAC/EgD,GAAI,OACJC,SAAU,mCAAWC,GAAX,UAAWA,MAAX,OAAuB,kBAAC9J,EAAA,EAAD,KAA4B8J,OAC3D,IACEC,EAAYN,mBAAQ,kBAAMO,IAAe7B,GAAmB1H,KAAI,SAAAwJ,GACpE,MAAO,CACLP,OAAQ,kBAAO,kBAAC1J,EAAA,EAAD,KAA4ByI,EAAYyB,WAAWC,IAAIF,GAAWH,OACjFH,OAAQ,wBAAMtB,EAAuB8B,IAAIF,IAActB,EAAgByB,SAASH,GAAa,MAA/E,UAAuF1B,EAAe4B,IAAIF,UAA1G,QAAwH,IACtIL,GAAIK,EACJJ,SAAU,YAA6B,IAAD,0BAAE,iBAAF,KAAjBK,WAAqCC,IAAIF,UAAtB,QAAoC,SAE5E,CAAC9B,EAAmBE,EAAwBE,EAAgBI,EAAiBF,IAC3E4B,EAAWZ,mBAAQ,iBAAO,CAC9BC,OAAQ,OACRC,OAAQ,GACRC,GAAI,OACJC,SAAU,YAA6B,IAAD,mBAA1BxC,EAA0B,YAAjBiD,EAAiB,EAAjBA,KAAMhD,EAAW,EAAXA,KAAY,OAAO,kBAACH,EAAD,CAAYC,OAAQkD,EAAMhD,KAAMA,EAAMD,OAAQA,QAC1F,IACEkD,EAAQd,mBAAQ,WACpB,OAAGF,EACMQ,EAAYS,QAAQhB,GAAciB,KAAKJ,GAEvCN,EAAYS,QAAQH,GAAYG,QAAQhB,KAEhD,CAACA,EAAcO,EAAaM,EAAYd,IACrCmB,EAAKjB,mBAAQ,kBACjBO,IAAe,CACbA,IAAenB,EAAe8B,KAAKlK,KAAI,SAAA4G,GAAM,MAAK,CAACA,EAAD,2BAAa0B,EAAU4B,IAAIR,IAAI9C,IAA/B,IAAwCC,KAAM,YAChG0C,IAAenB,EAAe+B,QAAQnK,KAAI,SAAA4G,GAAM,MAAK,CAACA,EAAD,2BAAa0B,EAAU6B,OAAOT,IAAI9C,IAAlC,IAA2CC,KAAM,eACtG0C,IAAenB,EAAegC,OAAOpK,KAAI,SAAA4G,GAAM,MAAK,CAACA,EAAD,2BAAa0B,EAAU8B,MAAMV,IAAI9C,IAAjC,IAA0CC,KAAM,gBACnGwD,SAAQ,KACX,CAACjC,EAAgBE,IAEbgC,EAAgBC,mBAAS,CAAET,UAASG,SAExCO,EAMEF,EANFE,cACAC,EAKEH,EALFG,kBACAC,EAIEJ,EAJFI,aACAC,EAGEL,EAHFK,aACAC,EAEEN,EAFFM,KACAC,EACEP,EADFO,WAGIC,EAAWhH,EAAkBjC,uBAAY,YAAsB,IAApByC,EAAmB,EAAnBA,MAAOC,EAAY,EAAZA,OACtDkE,EAAgBnE,GAChBqE,EAAiBpE,KAChB,CAACoE,KAEEoC,EAAQjH,EAAkBjC,uBAAY,YAAc,IAAZyC,EAAW,EAAXA,MAC5CuE,EAAavE,KACZ,CAACuE,KAEJ,OACE,kBAAC,aAAD,CACEmC,UAAQ,EACRjF,MAAO,CAACzB,MAAO,QACf2G,YAAU,EACVC,cAAc,kCACdC,sBAAuB,SAAAzL,GACrB,IAAM0L,EAAaC,IAAO3L,EAAMqG,MAAM,CAAEuF,OAAQ,CAC9CC,MAAO,EACPC,OAAQ,EACRC,KAAM,EACNC,aAAc,EACdC,WAAYnD,EACZoD,YAAa9C,EAAKF,EAAY,KAEhC,OAAO,yCAASlJ,EAAT,CAAgBqG,MAAOqF,MAGhCS,oBAAqB,SAAAnM,GACnB,IAAM0L,EAAaC,IAAO3L,EAAMqG,MAAM,CAAEuF,OAAQ,CAC9CC,MAAO,EACPC,OAAQ,EACRM,IAAK,EACLJ,aAAc,EACdK,UAAWrD,KAEb,OAAO,yCAAShJ,EAAT,CAAgBqG,MAAOqF,OAIhC,kBAACY,EAAA,EAAD,eAAOC,SAAO,EAACC,UAAQ,EAACC,OAAK,GAAK3B,EAAc,CAC9CzE,MAAO,MAEP,+BAEI2E,EAAa1K,KAAI,SAAAoM,GAAW,OAC1B,uBAAQA,EAAYC,sBAEhBD,EAAYE,QAAQtM,KAAI,SAAAuM,GACtB,OAAIA,EAAOtD,OAEW,SAAZsD,EAAOpD,GAEb,wCAAQoD,EAAOC,eAAe,CAC5BrG,UAAW,kEADb,CAEIzE,IAAKqJ,IAELwB,EAAOE,OAAO,WAMlB,uBAAQF,EAAOC,eAAe,CAC5BrG,UAAW,iDAGToG,EAAOE,OAAO,WAjBb,wCAAQF,EAAOC,eAAe,CAACrG,UAAW,uDAA1C,CAAkGzE,IAAKoJ,aA6B5H,0BAAWL,IAETG,EAAK5K,KAAI,SAAA0M,GAEP,OADA7B,EAAW6B,GAET,uBAAQA,EAAIC,cAERD,EAAIE,MAAM5M,KAAI,SAAA6M,GACZ,MAAoB,SAAjBA,EAAKN,OAAOpD,GAEX,uBAAQ0D,EAAKC,aAAa,CACxB3G,UAAW,kDAGT0G,EAAKJ,OAAO,SAIO,SAAjBI,EAAKN,OAAOpD,GAElB,uBAAQ0D,EAAKC,aAAa,CACxB3G,UAAW,kDAGT0G,EAAKJ,OAAO,SAMhB,uBAAQI,EAAKC,aAAa,CACxB3G,UAAW,0BAGT0G,EAAKJ,OAAO,iBAWhC,+BACG9B,EAAa3K,KAAI,SAAA+M,GAAK,OACrB,uBAAQA,EAAMC,sBAEVD,EAAMT,QAAQtM,KAAI,SAAAuM,GAChB,MAAe,SAAZA,EAAOpD,GAEN,uBAAQoD,EAAOU,eAAe,CAC5B9G,UAAW,kDAGToG,EAAOE,OAAO,WAIA,SAAZF,EAAOpD,GAEb,uBAAQoD,EAAOU,eAAe,CAC5B9G,UAAW,8DAGToG,EAAOE,OAAO,WAMlB,uBAAQF,EAAOU,eAAe,CAC5B9G,UAAW,iCAGToG,EAAOE,OAAO,wBAgBzBjF","file":"static/js/15.1acafa53.chunk.js","sourcesContent":["import React from \"react\";\r\n\r\nconst FormattedChemicalCompound=React.memo((props) => {\r\n  /*\r\n  WordMatcher=(.*?[^0-9\\[\\(])\r\n  SubMatcher=([0-9])\r\n  EndMatcher=([$\\s])\r\n  SupMatcher=([+-])(?:(?:1|([2-9]))|{EndMatcher})\r\n  WholeExp={WordMatcher}(?:{EndMatcher}|{SubMatcher}{SupMatcher}?|{SupMatcher})\r\n  (WordMatcher[0])_(SubMatcher[0])^(SupMatcher[1]SupMatcher[0])EndMatcher[0]\r\n  That would only work with ruby where the capture groups are changed on every recursion\r\n  */\r\n  //https://regex101.com/r/POrbvL/4\r\n  const regex=/(?<WordMatcher>.*?[^0-9[(\\s])(?:(?<EndMatcher1>$|[:.\\s])|(?<Charge1>(?<ChargeSign1>[+-])(?:(?:1|(?<ChargeValue1>[2-9]))|(?<EndMatcher2>$|[:.\\s])))|(?<SubMatcher>[0-9]+)(?<Charge2>(?<ChargeSign2>[+-])(?:(?:1|(?<ChargeValue2>[2-9]))|(?<EndMatcher3>$|[:.\\s])))?)(?<EndMatcher4>$|[:.\\s])?/g;\r\n  //$<WordMatcher>_($<SubMatcher>)^($<ChargeValue1>$<ChargeValue2>$<ChargeSign1>$<ChargeSign2>)$<EndMatcher1>$<EndMatcher2>$<EndMatcher3>\r\n  return(\r\n    <div {...props}>\r\n        {Array.from(props.children.matchAll(regex)).map((match) => {\r\n          const chargeValue=[match.groups.ChargeValue1, match.groups.ChargeValue2].reduce((prev, curr) => curr ? curr : prev, \"\");\r\n          const chargeSign=[match.groups.ChargeSign1, match.groups.ChargeSign2].reduce((prev, curr) => curr ? curr : prev, \"\");\r\n          const terminator=[match.groups.EndMatcher1, match.groups.EndMatcher2, match.groups.EndMatcher3, match.groups.EndMatcher4].reduce((prev, curr) => curr ? curr : prev, \"\");\r\n          return (\r\n            <span key={props.children.substring(0, match.index)}>\r\n              {match.groups.WordMatcher}<sub>{match.groups.SubMatcher}</sub><sup>{chargeValue}{chargeSign}</sup>{terminator}\r\n            </span>\r\n          );\r\n        })\r\n        }\r\n    </div>\r\n  );\r\n});\r\nexport default FormattedChemicalCompound;","import { useCallback, useRef } from \"react\";\r\n\r\nconst useCallbackRef=(onUpdate , cleanupOld, onNull=() => {}) => {\r\n  const ref = useRef(null)\r\n  const setRef = useCallback(node => {\r\n    if (ref.current) {\r\n      cleanupOld(ref.current);\r\n    } \r\n    \r\n    if (node) {\r\n      onUpdate(node)\r\n    } else {\r\n      onNull();\r\n    }\r\n    \r\n    ref.current = node\r\n  }, [cleanupOld, onUpdate, onNull])\r\n  \r\n  return setRef\r\n}\r\n\r\nconst mergeRefs = (...refs) => {\r\n  const filteredRefs = refs.filter(Boolean);\r\n  if (!filteredRefs.length) return null;\r\n  if (filteredRefs.length === 0) return filteredRefs[0];\r\n  return inst => {\r\n    for (const ref of filteredRefs) {\r\n      if (typeof ref === 'function') {\r\n        ref(inst);\r\n      } else if (ref) {\r\n        ref.current = inst;\r\n      }\r\n    }\r\n  };\r\n};\r\n\r\nexport {useCallbackRef, mergeRefs};","import React, { useState, useRef, useEffect } from 'react';\r\nimport { mergeRefs } from './ref-utils';\r\n\r\nconst ConstantValidationTextInput=React.memo((props) => {\r\n  const child=React.Children.only(props.children);\r\n  const [value, setValue]=useState(\"\");\r\n  const [selection, setSelection]=useState([0,0]);\r\n  const [validationMisfired, setValidationMisfire]=useState(false);\r\n  const selectRef=useRef(null);\r\n  const onBlur=(e) => {\r\n    props.onBlur(e, setValue);\r\n  }\r\n\r\n  const onChange=(e) => {\r\n    if(props.validation(e.target.value)){\r\n      props.onChange(e);\r\n      setValue(e.target.value);\r\n      setSelection([e.target.selectionStart, e.target.selectionEnd]);\r\n    } else {\r\n      setValidationMisfire(true);\r\n    }\r\n  }\r\n  const onSelect=(e) => {\r\n    if(!validationMisfired){\r\n      setSelection([e.target.selectionStart, e.target.selectionEnd]);\r\n    }\r\n  }\r\n  useEffect(() => {\r\n    if(validationMisfired) {\r\n      selectRef.current.selectionStart=selection[0];\r\n      selectRef.current.selectionEnd=selection[1];\r\n      setValidationMisfire(false);\r\n    }\r\n  }, [validationMisfired, selection]);\r\n  return(\r\n    <>\r\n      {React.cloneElement(child, { value: value, onSelect: onSelect, onChange: onChange, onBlur: onBlur, ref: mergeRefs(child.ref, selectRef)})}\r\n    </>\r\n  )\r\n});\r\nConstantValidationTextInput.defaultProps={\r\n  onChange: () => {},\r\n  onBlur: () => {},\r\n};\r\n\r\nexport default ConstantValidationTextInput;","import { useRef, useCallback } from \"react\";\r\nimport { useCallbackRef } from \"./ref-utils\";\r\n\r\nconst useResizeObserver=(callback) => {\r\n  const resizeObserverRef=useRef(null);\r\n  const getResizeObserverRef=useCallback(() => {\r\n    if(!resizeObserverRef.current){\r\n      resizeObserverRef.current=new ResizeObserver((entries) => {\r\n        const boundingRect=entries[0].target.getBoundingClientRect();\r\n        callback({width: boundingRect.width, height: boundingRect.height})\r\n      })\r\n    }\r\n    return resizeObserverRef;\r\n  }, [resizeObserverRef, callback])\r\n  const nodeRef=useCallbackRef(\r\n    useCallback((node) => {\r\n      getResizeObserverRef().current.observe(node)\r\n    },[getResizeObserverRef]),\r\n    useCallback((node) => {\r\n      getResizeObserverRef().current.unobserve(node)\r\n    },[getResizeObserverRef])\r\n  )\r\n  return nodeRef;\r\n}\r\n\r\nexport default useResizeObserver;","import React, { useState, useRef, useLayoutEffect } from \"react\";\r\n\r\nimport Form from \"react-bootstrap/Form\";\r\nimport ConstantValidationTextInput from \"../utils/ConstantValidationTextInput\";\r\n\r\nconst EditDefault = React.memo(({constantValidation, onSubmitValidation, onResetToDefault, onEdit, defaultValue, changedValue }) => {\r\n  const showDefault = !changedValue;\r\n  const [editing, setEditing] = useState(false);\r\n  const [editBoxVal, setEditBoxVal] = useState(\"\");\r\n\r\n  const editBoxRef=useRef();\r\n\r\n  useLayoutEffect (() => {\r\n    if(editing){\r\n      editBoxRef.current.focus();\r\n    }\r\n  }, [editing, editBoxRef]);\r\n\r\n  const onCancelEdit=(e) => {\r\n    setEditing(false);\r\n    setEditBoxVal(\"\");\r\n  };\r\n  const onSubmitEdit=(e) => {\r\n    e.preventDefault();\r\n    if(onSubmitValidation(editBoxVal)) {\r\n      onEdit(editBoxVal);\r\n    }\r\n    onCancelEdit(e);\r\n  }\r\n  const beginEdit=(e) => {\r\n    setEditing(true);\r\n  }\r\n  const resetToDefault=(e) => {\r\n    onResetToDefault();\r\n  }\r\n\r\n  if(editing){\r\n    return (\r\n      <Form onSubmit={onSubmitEdit}>\r\n        <ConstantValidationTextInput \r\n          validation={constantValidation} \r\n          onChange={(e) => {\r\n            setEditBoxVal(e.target.value);\r\n          }} \r\n          onBlur={onSubmitEdit}\r\n        >\r\n          <Form.Control \r\n            ref={editBoxRef}\r\n            style={{\"width\": \"80px\"}} \r\n            onKeyDown={(e) => {\r\n              if(e.keyCode===27){\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                onCancelEdit(e);\r\n              }\r\n            }}/>\r\n        </ConstantValidationTextInput>\r\n      </Form>\r\n    )\r\n  } else if(showDefault) {\r\n    return (\r\n      <span className=\"text-nowrap\">\r\n        {defaultValue}\r\n        <svg onClick={beginEdit} className=\"logK-editor\" style={{\"marginTop\": \"-0.2rem\"}} width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n          <path fillRule=\"evenodd\" d=\"M11.293 1.293a1 1 0 0 1 1.414 0l2 2a1 1 0 0 1 0 1.414l-9 9a1 1 0 0 1-.39.242l-3 1a1 1 0 0 1-1.266-1.265l1-3a1 1 0 0 1 .242-.391l9-9zM12 2l2 2-9 9-3 1 1-3 9-9z\"></path>\r\n          <path fillRule=\"evenodd\" d=\"M12.146 6.354l-2.5-2.5.708-.708 2.5 2.5-.707.708zM3 10v.5a.5.5 0 0 0 .5.5H4v.5a.5.5 0 0 0 .5.5H5v.5a.5.5 0 0 0 .5.5H6v-1.5a.5.5 0 0 0-.5-.5H5v-.5a.5.5 0 0 0-.5-.5H3z\"></path>\r\n        </svg>\r\n      </span>\r\n    )\r\n  } else {\r\n    return (\r\n      <span className=\"text-nowrap\">\r\n        {changedValue}\r\n        <svg onClick={resetToDefault} className=\"logK-reset\" style={{\"marginTop\" : \"-0.12rem\"}} width=\"1em\" height=\"1em\" viewBox=\"0 0 16 16\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\r\n          <path fillRule=\"evenodd\" d=\"M12.83 6.706a5 5 0 0 0-7.103-3.16.5.5 0 1 1-.454-.892A6 6 0 1 1 2.545 5.5a.5.5 0 1 1 .91.417 5 5 0 1 0 9.375.789z\"></path>\r\n          <path fillRule=\"evenodd\" d=\"M7.854.146a.5.5 0 0 0-.708 0l-2.5 2.5a.5.5 0 0 0 0 .708l2.5 2.5a.5.5 0 1 0 .708-.708L5.707 3 7.854.854a.5.5 0 0 0 0-.708z\"></path>\r\n        </svg>\r\n      </span>\r\n    )\r\n  }\r\n});\r\n\r\nexport default EditDefault;","import React, { useState, useMemo, useCallback } from 'react';\r\n\r\nimport useResizeObserver from '../../../utils/useResizeObserver.js';\r\n\r\n\r\nimport * as Immutable from \"immutable\";\r\nimport update from \"immutability-helper\";\r\n\r\nimport { Scrollbars } from 'react-custom-scrollbars';\r\n\r\nimport { useTable } from 'react-table';\r\n\r\nimport Table from 'react-bootstrap/Table';\r\nimport is_number from 'is-number';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { addLogKChange, removeLogKChange } from '../speciesSlice';\r\nimport { getLogKChange, getSpeciesDB, getSpeciesPresent } from '../speciesSelectors';\r\nimport { getComponentDB, getComponentsAtEquilibrium, getComponentsConc, getComponentsPresent } from '../../components/componentsSelectors';\r\nimport EditDefault from '../../../reusable_components/EditDefault';\r\nimport FormattedChemicalCompound from '../../../reusable_components/formatting/FormattedChemicalCompound.js';\r\nimport { getGasReplacements } from '../gases/gasInputSlice.js';\r\n\r\nconst LogKEditor=React.memo((props) => {\r\n  const { dbLogK, specie, type} = props;\r\n  const dispatch=useDispatch();\r\n  return  (\r\n    <EditDefault\r\n      constantValidation={(input) => input.match(/^-?\\d*\\.?\\d*$/)}\r\n      onSubmitValidation={is_number}\r\n      defaultValue={dbLogK}\r\n      changedValue={useSelector(state => getLogKChange(state, {specie, type}))}\r\n      onEdit={(value) => {\r\n        dispatch(addLogKChange({specie, type, value: Number(value)}));\r\n      }}\r\n      onResetToDefault={() => {\r\n        dispatch(removeLogKChange({specie, type}));\r\n      }}\r\n    />\r\n  )\r\n});\r\n\r\nconst TableauTable=React.memo((props) => {\r\n  const {windowWidth}=props;\r\n\r\n  const componentsPresent=useSelector(getComponentsPresent);\r\n  const componentsAtEquilibium=useSelector(getComponentsAtEquilibrium);\r\n  const componentsConc=useSelector(getComponentsConc);\r\n  const componentDB=useSelector(getComponentDB);\r\n  const gasReplacements=useSelector(getGasReplacements);\r\n\r\n  const speciesPresent=useSelector(getSpeciesPresent);\r\n  const speciesDB=useSelector(getSpeciesDB);\r\n\r\n  const [topLeftWidth, setTopLeftWidth]=useState(0);\r\n  const [topLeftHeight, setTopLeftHeight]=useState(0);\r\n  const [logKWidth, setLogKWidth]=useState(0);\r\n  const lg=windowWidth>=992;\r\n  const headerColumn=useMemo(() => ({\r\n    Header: \"\",\r\n    Footer: () => (<><span className=\"d-none d-xl-block\">Total Concentration</span><span className=\"d-block d-xl-none\">Total Conc.</span></>),\r\n    id: \"name\",\r\n    accessor: ([specie, {name}]) => (<FormattedChemicalCompound>{name}</FormattedChemicalCompound>),\r\n  }), []);\r\n  const dataColumns=useMemo(() => Immutable.List(componentsPresent).map(component => {\r\n    return {\r\n      Header: () => (<FormattedChemicalCompound>{componentDB.components.get(component).name}</FormattedChemicalCompound>),\r\n      Footer: () => componentsAtEquilibium.get(component) || gasReplacements.includes(component) ? \"TBC\" : componentsConc.get(component) ?? \"\", \r\n      id: component,\r\n      accessor: ([specie, {components}]) => { return components.get(component) ?? 0},\r\n    }\r\n  }), [componentsPresent, componentsAtEquilibium, componentsConc, gasReplacements, componentDB]);\r\n  const logKColumn=useMemo(() => ({\r\n    Header: \"logK\",\r\n    Footer: \"\",\r\n    id: \"logK\",\r\n    accessor: ([specie, {logK, type}]) => {return <LogKEditor dbLogK={logK} type={type} specie={specie}/>},\r\n  }), []);\r\n  const columns=useMemo(() => {\r\n    if(lg){\r\n      return dataColumns.unshift(headerColumn).push(logKColumn);\r\n    } else {\r\n      return dataColumns.unshift(logKColumn).unshift(headerColumn);\r\n    }\r\n  }, [headerColumn, dataColumns, logKColumn, lg]);\r\n  const data=useMemo(() => \r\n    Immutable.List([\r\n      Immutable.List(speciesPresent.aqs).map(specie => ([specie, {...speciesDB.aqs.get(specie), type: \"aqs\"}])),\r\n      Immutable.List(speciesPresent.solids).map(specie => ([specie, {...speciesDB.solids.get(specie), type: \"solids\"}])),\r\n      Immutable.List(speciesPresent.gases).map(specie => ([specie, {...speciesDB.gases.get(specie), type: \"gases\"}])),\r\n    ]).flatten(true)\r\n  , [speciesPresent, speciesDB]);\r\n\r\n  const tableInstance = useTable({ columns, data });\r\n  const {\r\n    getTableProps,\r\n    getTableBodyProps,\r\n    headerGroups,\r\n    footerGroups,\r\n    rows,\r\n    prepareRow,\r\n  } = tableInstance;\r\n\r\n  const topLeftRef=useResizeObserver(useCallback(({width, height}) => {\r\n    setTopLeftWidth(width);\r\n    setTopLeftHeight(height);\r\n  }, [setTopLeftHeight]));\r\n  \r\n  const logKRef=useResizeObserver(useCallback(({width}) => {\r\n    setLogKWidth(width);\r\n  }, [setLogKWidth]));\r\n  \r\n  return(\r\n    <Scrollbars \r\n      autoHide\r\n      style={{width: \"100%\"}}\r\n      autoHeight\r\n      autoHeightMax=\"calc(90vh - 63px - 71px - 2rem)\"\r\n      renderTrackHorizontal={props => {\r\n        const finalStyle = update(props.style,{ $merge: {\r\n          right: 2,\r\n          bottom: 2,\r\n          left: 2,\r\n          borderRadius: 3,\r\n          marginLeft: topLeftWidth,\r\n          marginRight: lg ? logKWidth : 0,\r\n        }});\r\n        return <div {...props} style={finalStyle}/>;\r\n        }\r\n      }\r\n      renderTrackVertical={props => {\r\n        const finalStyle = update(props.style,{ $merge: {\r\n          right: 2,\r\n          bottom: 2,\r\n          top: 2,\r\n          borderRadius: 3,\r\n          marginTop: topLeftHeight,\r\n        }});\r\n        return <div {...props} style={finalStyle}/>;\r\n        }\r\n      }\r\n    >\r\n      <Table striped bordered hover {...getTableProps({\r\n        style: {}\r\n      })}>\r\n        <thead>\r\n          {\r\n            headerGroups.map(headerGroup => (\r\n              <tr {...headerGroup.getHeaderGroupProps()}>\r\n                {\r\n                  headerGroup.headers.map(column => {\r\n                    if(!column.Header){\r\n                      return <th {...column.getHeaderProps({className: \"sticky sticky-header-y sticky-header-x-lg bg-white\"})} ref={topLeftRef} />\r\n                    } else if(column.id===\"logK\"){\r\n                      return (\r\n                        <th {...column.getHeaderProps({\r\n                          className: \"vertical-align-middle sticky-header-y sticky-column-lg sticky\",\r\n                        })} ref={logKRef}>\r\n                          {\r\n                            column.render('Header')\r\n                          }\r\n                        </th>\r\n                      )\r\n                    } else {\r\n                      return (\r\n                        <th {...column.getHeaderProps({\r\n                          className: \"vertical-align-middle sticky-header-y sticky\",\r\n                        })}>\r\n                          {\r\n                            column.render('Header')\r\n                          }\r\n                        </th>\r\n                      )\r\n                    }\r\n                  })\r\n                }\r\n              </tr>\r\n            ))\r\n          }\r\n        </thead>\r\n        \r\n        <tbody {...getTableBodyProps()}>\r\n          {\r\n          rows.map(row => {\r\n            prepareRow(row)\r\n            return (\r\n              <tr {...row.getRowProps()}>\r\n                {\r\n                  row.cells.map(cell => {\r\n                    if(cell.column.id===\"name\"){\r\n                      return (\r\n                        <th {...cell.getCellProps({\r\n                          className: \"vertical-align-middle sticky-header-lg sticky\",\r\n                        })}>\r\n                          {\r\n                            cell.render('Cell')\r\n                          }\r\n                        </th>\r\n                      )\r\n                    } else if(cell.column.id===\"logK\"){\r\n                      return (\r\n                        <td {...cell.getCellProps({\r\n                          className: \"vertical-align-middle sticky-column-lg sticky\",\r\n                        })}>\r\n                          {\r\n                            cell.render('Cell')\r\n                          }\r\n                        </td>\r\n                      )\r\n                    } else {\r\n                      return (\r\n                        <td {...cell.getCellProps({\r\n                          className: \"vertical-align-middle\",\r\n                        })}>\r\n                          {\r\n                            cell.render('Cell')\r\n                          }\r\n                        </td>\r\n                      )\r\n                    }\r\n                  })\r\n                }\r\n              </tr>\r\n            )\r\n          })}\r\n        </tbody>\r\n        <tfoot>\r\n          {footerGroups.map(group => (\r\n            <tr {...group.getFooterGroupProps()}>\r\n              {\r\n                group.headers.map(column => {\r\n                  if(column.id===\"name\"){\r\n                    return (\r\n                      <th {...column.getFooterProps({\r\n                        className: \"vertical-align-middle sticky-header-lg sticky\",\r\n                      })}>\r\n                        {\r\n                          column.render('Footer')\r\n                        }\r\n                      </th>\r\n                    );\r\n                  } else if(column.id===\"logK\"){\r\n                    return (\r\n                      <th {...column.getFooterProps({\r\n                        className: \"vertical-align-middle crossed-out sticky-column-lg sticky\",\r\n                      })}>\r\n                        {\r\n                          column.render('Footer')\r\n                        }\r\n                      </th>\r\n                    )\r\n                  } else {\r\n                    return (\r\n                      <td {...column.getFooterProps({\r\n                        className: \"vertical-align-middle sticky\",\r\n                      })}>\r\n                        {\r\n                          column.render('Footer')\r\n                        }\r\n                      </td>\r\n                    );\r\n                  }\r\n                  \r\n                })\r\n              }\r\n            </tr>\r\n          ))}\r\n        </tfoot>\r\n      </Table>\r\n    </Scrollbars>\r\n  )\r\n});\r\n\r\nexport default TableauTable;"],"sourceRoot":""}